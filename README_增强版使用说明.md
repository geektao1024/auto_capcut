# 🎬 CapCut 草稿自动生成器 - 增强版 v2.0

## ✨ 新功能

### 1️⃣ **音频智能分段** ⭐⭐⭐⭐⭐

**自动检测并移除静音，将音频切分成多个独立片段**

```
原音频：  ━━━ [静音500ms] ━━━━ [静音800ms] ━ [静音600ms] ━━━━

智能分段后，在 CapCut 中：
音频轨道：
┌────┐        ┌──────┐      ┌──┐      ┌──────┐
│片段1│        │片段2 │      │片3│      │片段4 │
└────┘        └──────┘      └──┘      └──────┘
  ↑              ↑            ↑           ↑
每个片段都可以单独调整、删除、移动
```

**优点：**
- ✅ 自动移除大部分静音
- ✅ 每个片段独立，可手动精修
- ✅ 脚本没删干净的，在 CapCut 中手动删除
- ✅ 可自由调整片段顺序

### 2️⃣ **详细日志记录** 📝

**每次运行都会生成详细日志，方便排查问题**

日志保存在：`/Users/mac/YouTube/01工具类/playwright/logs/`

日志包含：
- ✅ 每个处理步骤的详细信息
- ✅ 文件路径、时长、参数
- ✅ 错误和警告信息
- ✅ 时间戳（精确到秒）

示例日志：
```
2025-10-14 15:30:45 [INFO] 📝 日志文件: /Users/mac/.../logs/0925 砸汽车拿灯泡_153045.log
2025-10-14 15:30:50 [DEBUG] 步骤 1/8: 获取模板草稿
2025-10-14 15:30:50 [DEBUG] 使用模板: 1014
2025-10-14 15:30:51 [DEBUG] 步骤 4/8: 音频智能分段
2025-10-14 15:30:52 [INFO] ✅ 检测到 4 个音频片段
2025-10-14 15:30:53 [DEBUG] 片段 1: 0.00s - 3.25s (时长 3.25s)
2025-10-14 15:30:53 [DEBUG] 片段 2: 4.10s - 7.80s (时长 3.70s)
...
```

### 3️⃣ **智能状态提示** 📊

文件夹列表现在显示状态图标：
- ✅ 绿勾：有音频+图片，可以直接使用
- ⚠️ 警告：缺少音频或图片，需要补充

---

## 🚀 快速开始

### 安装依赖

```bash
pip3 install pydub mutagen
```

### 运行方式

**方法 1：双击启动（推荐）**
```
双击 "生成草稿.command" 文件
```

**方法 2：命令行**
```bash
cd /Users/mac/YouTube/01工具类/playwright
python3 auto_capcut_draft_enhanced.py
```

---

## 📖 完整使用流程

### 步骤 1：选择文件夹

```
======================================================================
📁 可用的素材文件夹:
======================================================================
✅ 19. 0925 砸汽车拿灯泡  [🎵 1 音频, 🖼️  16 图片]  ← 推荐
✅ 22. 0922 糖果          [🎵 1 音频, 🖼️  18 图片]  ← 推荐
⚠️  1. 1013 挖泳池        [🎵 1 音频, 🖼️  0 图片]   ← 缺图片

请选择文件夹编号: 19
```

### 步骤 2：选择是否启用音频分段

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔇 是否启用音频智能分段？
   - 自动检测并移除静音片段
   - 在 CapCut 中每个片段独立，可手动调整
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
启用分段？(y/n，默认y): y

分段模式:
  1. 保守 (>500ms, <-45dB) - 保留更多停顿
  2. 标准 (>500ms, <-40dB) - 平衡效果 ⭐
  3. 激进 (>300ms, <-35dB) - 删除更多间隙

选择模式 (1-3，默认2): 2
```

### 步骤 3：查看处理结果

```
🔧 开始音频智能分段...
✅ 检测到 4 个音频片段

📊 分段统计:
  原时长: 19.64秒
  新时长: 12.35秒
  移除: 7.29秒 (37.1%)
  片段数: 4 个

✅ 复制 4 个音频片段
✅ 复制 16 张图片
```

### 步骤 4：草稿创建完成

```
======================================================================
✅ 草稿创建完成！
======================================================================
📝 草稿名称: 0925 砸汽车拿灯泡_153045
📁 草稿路径: ~/Movies/CapCut/.../0925 砸汽车拿灯泡_153045
⏱️  总时长: 12.35 秒
🎵 音频片段: 4 个（独立可调）  ← 注意这里！
🖼️  图片片段: 16 个
📝 日志文件: .../logs/0925 砸汽车拿灯泡_153045.log
```

### 步骤 5：在 CapCut 中打开

1. 打开 CapCut
2. 找到新创建的草稿
3. **查看音频轨道** - 你会看到 4 个独立的音频片段
4. **手动精修**：
   - 拖动片段调整顺序
   - 删除多余的片段
   - 调整片段时长
   - 删除脚本没删干净的静音

---

## 🎯 音频分段模式对比

| 模式 | 参数 | 适用场景 | 效果 |
|------|------|---------|------|
| **保守** | >500ms, <-45dB | 需要保留自然停顿 | 删除最少 |
| **标准** ⭐ | >500ms, <-40dB | 一般口播视频 | 平衡效果 |
| **激进** | >300ms, <-35dB | 快节奏视频 | 删除最多 |

**参数说明：**
- `min_silence_len`：静音长度阈值（毫秒）
  - 500ms：超过0.5秒的静音才会被移除
  - 300ms：超过0.3秒的静音就会被移除
  
- `silence_thresh`：静音音量阈值（分贝）
  - -45dB：非常安静才算静音（保守）
  - -40dB：比较安静就算静音（标准）
  - -35dB：稍微安静就算静音（激进）

---

## 📊 在 CapCut 中的效果

### 音频轨道显示（分段后）

```
音频轨道：
┌──────────┐  ┌────────────┐  ┌────┐  ┌──────────────┐
│ audio_01 │  │  audio_02  │  │au03│  │   audio_04   │
│ (3.25s)  │  │   (3.70s)  │  │1.2s│  │    (4.20s)   │
└──────────┘  └────────────┘  └────┘  └──────────────┘
    ↓              ↓            ↓           ↓
  可单独选中、删除、移动、调整音量、添加淡入淡出
```

### 你可以做的调整

1. **删除片段**
   - 选中某个音频片段 → 按 Delete
   - 例如：删除一个口误片段

2. **调整顺序**
   - 拖动片段到新位置
   - 例如：重新排列句子顺序

3. **微调时长**
   - 拖动片段边缘
   - 例如：延长某个片段0.5秒

4. **添加效果**
   - 淡入淡出
   - 音量调整
   - 变速效果

---

## 🐛 问题排查

### 查看日志

所有日志保存在：`logs/` 文件夹

每次运行生成一个日志文件，包含：
- 详细的处理步骤
- 错误和警告信息
- 文件路径和参数

### 常见问题

**Q1: 音频分段功能不可用**

```
⚠️  pydub 未安装
```

**解决：**
```bash
pip3 install pydub
```

**Q2: 分段后没有检测到音频片段**

检查日志文件，可能原因：
- 音频本身就没有静音
- 静音阈值设置过严

**解决：**
- 选择"激进"模式重试
- 或选择"n"跳过分段，使用原音频

**Q3: CapCut 中看不到多个片段**

检查：
1. 确认在创建草稿时选择了 "y" 启用分段
2. 查看日志确认检测到了多个片段
3. 在 CapCut 中放大音频轨道查看

**Q4: 某些片段想保留但被删除了**

**解决：**
- 下次使用"保守"模式
- 或在 CapCut 中手动调整（这就是分段的优势！）

---

## 💡 使用技巧

### 技巧 1：分段后的精修工作流

```
1. 运行脚本（标准模式）
   ↓
2. 在 CapCut 打开草稿
   ↓
3. 播放预览，找出问题片段
   ↓
4. 手动删除/调整有问题的片段
   ↓
5. 添加字幕、转场、特效
   ↓
6. 导出视频
```

### 技巧 2：不同类型视频的模式选择

- **教程视频**：保守模式（保留思考停顿）
- **故事口播**：标准模式（平衡效果）
- **快节奏视频**：激进模式（节奏紧凑）

### 技巧 3：批量处理

```bash
# 一次处理多个项目
# 每个项目生成独立的日志文件
# 方便对比和排查
```

---

## 📂 文件结构

```
/Users/mac/YouTube/01工具类/playwright/
├── auto_capcut_draft_enhanced.py  # 主程序（增强版）
├── auto_capcut_draft.py           # 旧版本（备份）
├── 生成草稿.command               # 启动脚本
├── logs/                          # 日志文件夹
│   ├── 0925 砸汽车拿灯泡_153045.log
│   ├── 0922 糖果_154230.log
│   └── ...
└── README_增强版使用说明.md       # 本文档
```

---

## 🎓 对比：方案 A vs 增强版

### 方案 A（全自动）

```
输入音频 → 移除静音 → 生成一整条音频 → 创建草稿
                                         ↓
                              无法在 CapCut 中调整
```

### 增强版（半自动化）⭐

```
输入音频 → 智能分段 → 多个独立片段 → 创建草稿
                                      ↓
                        在 CapCut 中可以：
                        - 删除片段
                        - 调整顺序
                        - 精修时长
                        - 添加效果
```

**增强版的优势：**
- ✅ 保留了自动化的效率
- ✅ 增加了人工干预的灵活性
- ✅ 脚本处理 80% 的工作
- ✅ 人工精修最后 20%
- ✅ 完美平衡！

---

## 📊 实际效果示例

### 案例：19秒音频处理

**原音频：**
- 总时长：19.64秒
- 包含多个停顿和口误

**智能分段后：**
- 有效时长：12.35秒
- 移除：7.29秒（37.1%）
- 片段数：4个

**在 CapCut 中：**
```
片段1 (3.25s) - "啊 为什么你在客厅挖了个大洞"
片段2 (3.70s) - "我在里面放积木块 现在"
片段3 (1.20s) - "我要往里倒水 然后 boom"
片段4 (4.20s) - "我的泳池准备好了 来吧"

→ 手动删除片段3中的 "boom"
→ 调整片段2和片段3之间的间隔
→ 完成！
```

---

## 🎉 总结

### 增强版解决的核心问题

**你的需求：**
> "我希望消除之后能在草稿中再进行微调，例如拆开后的音频我可以在草稿内可以看见。同时可以对多余没消除的进行进一步的消除"

**增强版的实现：**
- ✅ 音频被拆分成独立片段
- ✅ 在 CapCut 中每个片段清晰可见
- ✅ 可以手动删除、调整任何片段
- ✅ 详细日志帮助定位问题

**工作流程：**
```
脚本自动化 (80%) + 人工精修 (20%) = 完美效果 (100%)
```

---

*增强版 v2.0 - 让自动化更智能，让创作更自由！* 🚀

